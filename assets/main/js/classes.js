// Generated by CoffeeScript 1.4.0
(function() {
  var App;

  App = {};

  App.metagames = [];

  App.players = [];

  App.minigames = [];

  App.Metagame = (function() {

    function Metagame() {
      this.id = 2;
    }

    Metagame.prototype.url = function() {
      return "/" + this.id;
    };

    Metagame.prototype.isAcceptingPlayers = function() {
      return true;
    };

    Metagame.prototype.serverInit = function(io) {
      var _this = this;
      return this.room = io.of("/" + this.id).on('connection', function(socket) {
        return socket.on('player added', function(data) {
          socket.broadcast.emit('player added', data);
          if (true) {
            return _this.start(socket);
          }
        });
      });
    };

    Metagame.prototype.start = function(socket) {
      this.currentMinigame = new App.Minigame;
      return socket.emit('load minigame', {
        src: this.currentMinigame.src
      });
    };

    Metagame.prototype.clientInit = function(io) {
      this.socket = io.connect("/" + this.id);
      this.socket.emit('player added', {
        player: App.player.name
      });
      this.socket.on('player added', function() {
        return console.log('player added');
      });
      return this.socket.on('load minigame', function(data) {
        console.log(data);
        return $.getScript(data.src).done(function(script, textStatus) {});
      });
    };

    Metagame.prototype.loadMinigame = function(src) {
      return $.getScript(data.src).done(function(script, textStatus) {});
    };

    return Metagame;

  })();

  App.Player = (function() {

    function Player(name) {
      this.name = name;
    }

    return Player;

  })();

  App.Minigame = (function() {

    function Minigame() {}

    Minigame.prototype.src = "/assets/minigames/default.js";

    return Minigame;

  })();

  if (typeof module !== "undefined" && module !== null) {
    module.exports = App;
  } else {
    window.App = App;
  }

}).call(this);
