// Generated by CoffeeScript 1.6.3
(function() {
  var oculusBridge, socket;

  window.App = {
    room: null,
    data: {},
    bridgeOrientationUpdated: function(quatValues) {
      var key, value, _results;
      _results = [];
      for (key in quatValues) {
        value = quatValues[key];
        _results.push($("#o" + (key.toUpperCase())).text(value.toFixed(2)));
      }
      return _results;
    },
    bridgeConnected: function() {
      $('#hud .oculus .disconnected').fadeOut(250);
      return $('#hud .oculus .connected').fadeIn(250);
    },
    bridgeDisconnected: function() {
      $('#hud .oculus .disconnected').fadeIn(250);
      return $('#hud .oculus .connected').fadeOut(250);
    }
  };

  socket = io.connect('/');

  socket.on("disconnect", function(data) {
    $('#disconnected').fadeIn(500);
    return setTimeout("location.href = '/'", 4500);
  });

  socket.on('connect', function() {
    socket.emit('init: add client');
    return console.log("Establishing room...");
  });

  socket.on("init: connected to room", function(data) {
    console.log("Connected to room: " + data.room);
    App.room = data.room;
    return $('#room').text(App.room);
  });

  socket.on("room: data", function(data) {
    var key, value, _results;
    $('#hud .controller .disconnected').fadeOut(250);
    $('#hud .controller .connected').fadeIn(250);
    App.data = data;
    _results = [];
    for (key in data) {
      value = data[key];
      if (typeof value === "number") {
        _results.push($("#" + key).text(value.toFixed(2)));
      } else {
        _results.push($("#" + key).text(value));
      }
    }
    return _results;
  });

  socket.on("server: controller disconnected", function(data) {
    $('#hud .controller .disconnected').fadeIn(250);
    return $('#hud .controller .connected').fadeOut(250);
  });

  oculusBridge = new OculusBridge({
    "debug": true,
    "onOrientationUpdate": App.bridgeOrientationUpdated,
    "onConnect": App.bridgeConnected,
    "onDisconnect": App.bridgeDisconnected
  });

  oculusBridge.connect();

}).call(this);
